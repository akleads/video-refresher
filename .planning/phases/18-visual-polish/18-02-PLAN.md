---
phase: 18-visual-polish
plan: 02
type: execute
wave: 2
depends_on: ["18-01"]
files_modified:
  - styles.css
  - views/upload.js
  - views/job-list.js
autonomous: true

must_haves:
  truths:
    - "Drop zone shows dashed border with upload cloud icon and helper text in idle state"
    - "Drop zone on drag-over changes to accent-colored border with glow effect and slight scale-up"
    - "Drop zone collapses after files are accepted, progress shown in separate section"
    - "Click anywhere on drop zone opens file picker"
    - "Job card filenames are the most prominent element (biggest/boldest text)"
    - "Job cards display in a multi-column grid (2-3 per row on desktop, 1 on narrow)"
    - "Source badge (Device/Server) is subtle and does not compete with filenames"
  artifacts:
    - path: "styles.css"
      provides: "Drop zone states CSS, job card grid, refined card hierarchy"
      contains: "drop-zone"
    - path: "views/upload.js"
      provides: "Drop zone with 3 visual states and collapse behavior"
    - path: "views/job-list.js"
      provides: "Job cards with prominent filenames and subtle badges"
  key_links:
    - from: "views/upload.js"
      to: "styles.css"
      via: "CSS classes for drop zone states"
      pattern: "drop-zone"
    - from: "views/job-list.js"
      to: "styles.css"
      via: "CSS classes for job card grid"
      pattern: "job-grid"
---

<objective>
Redesign the upload drop zone with 3 distinct visual states (idle, drag-over, collapsed) and refine job cards into a multi-column grid with clear filename hierarchy.

Purpose: Make the upload experience feel responsive and professional, and make the job list scannable with filenames as the primary visual element.
Output: Updated styles.css with drop zone and job card CSS. Rewritten upload.js with drop zone collapse behavior. Updated job-list.js with grid layout and refined card hierarchy.
</objective>

<execution_context>
@/Users/alexkozhemiachenko/.claude/get-shit-done/workflows/execute-plan.md
@/Users/alexkozhemiachenko/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/18-visual-polish/18-CONTEXT.md
@.planning/phases/18-visual-polish/18-01-SUMMARY.md
@styles.css
@views/upload.js
@views/job-list.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Drop zone CSS and job card grid CSS</name>
  <files>styles.css</files>
  <action>
**Drop zone CSS classes** -- add to styles.css:

`.drop-zone` (idle state):
- border: 2px dashed `--color-border-subtle`
- border-radius: `--radius-lg`
- padding: `--space-8` (32px) vertical, `--space-4` (16px) horizontal
- text-align: center
- cursor: pointer
- transition: all 0.2s ease
- background: transparent

`.drop-zone-icon`:
- font-size: 48px (for SVG/text icon)
- color: `--color-text-muted`
- margin-bottom: `--space-2` (8px)
- line-height: 1
- (This will hold an SVG upload cloud icon, rendered as innerHTML or text content)

`.drop-zone-text`:
- font-size: `--font-size-base`
- color: `--color-text-secondary`
- margin: 0

`.drop-zone-hint`:
- font-size: `--font-size-sm`
- color: `--color-text-muted`
- margin-top: `--space-1` (4px)

`.drop-zone.dragover` (drag-over state):
- border-color: `--color-accent`
- background: rgba(59, 130, 246, 0.05)
- box-shadow: 0 0 20px rgba(59, 130, 246, 0.15), inset 0 0 20px rgba(59, 130, 246, 0.05)
- transform: scale(1.01)

`.drop-zone.collapsed` (after files accepted):
- padding: `--space-3` (12px)
- border-style: solid
- border-color: `--color-border`
- cursor: pointer
- display: flex
- align-items: center
- justify-content: center
- gap: `--space-2` (8px)

`.drop-zone.collapsed .drop-zone-icon,
 .drop-zone.collapsed .drop-zone-text,
 .drop-zone.collapsed .drop-zone-hint`:
- display: none

`.drop-zone-collapsed-label`:
- font-size: `--font-size-sm`
- color: `--color-text-secondary`

**Upload view helper classes** (migrate inline styles):
- `.upload-wrapper` — padding: `--space-4` (16px)
- `.upload-title` — font-size: `--font-size-xl`, font-weight: bold, margin-bottom: `--space-1` (4px)
- `.upload-instructions` — color: `--color-text-secondary`, margin-bottom: `--space-6` (24px), font-size: `--font-size-sm`
- `.upload-mode-section` — display: flex, align-items: center, gap: `--space-6` (24px), margin-bottom: `--space-4` (16px)
- `.upload-mode-option` — display: flex, align-items: center, gap: `--space-2` (8px), cursor: pointer
- `.upload-warning` — background: `--color-warning-bg`, color: `--color-warning-text`, padding: `--space-3` (12px), border-radius: `--radius-md`, margin-top: `--space-3` (12px), font-size: `--font-size-sm`, display: none
- `.upload-file-list` — margin-top: `--space-4` (16px)
- `.upload-file-row` — display: flex, align-items: center, justify-content: space-between, padding: `--space-3` (12px), border-bottom: 1px solid `--color-border`
- `.upload-file-row:last-child` — border-bottom: none
- `.upload-file-name` — font-weight: `--font-weight-semibold`, font-size: `--font-size-sm`
- `.upload-file-size` — color: `--color-text-secondary`, font-size: `--font-size-xs`, margin-top: `--space-1` (4px)
- `.upload-file-remove` — btn-like: padding `--space-1` (4px) `--space-2` (8px), background transparent, color `--color-red-500`, border: 1px solid `--color-red-500`, border-radius: `--radius-sm`, cursor: pointer, font-size: `--font-size-xs`. Hover: background `--color-red-500`, color white
- `.upload-variation-section` — margin-top: `--space-4` (16px), display: flex, align-items: center, gap: `--space-3` (12px)
- `.upload-variation-input` — width: 60px, padding: `--space-2` (8px), font-size: `--font-size-sm`, border: 1px solid `--color-input-border`, border-radius: `--radius-sm`, background: `--color-input-bg`, color: `--color-input-text`, text-align: center
- `.upload-submit` — margin-top: `--space-4` (16px), width: 100%, padding: `--space-3` (12px), font-size: `--font-size-base`, border: none, border-radius: `--radius-md`, cursor: pointer, font-weight: `--font-weight-medium`, transition: all 0.2s. Default state (disabled): background `--color-gray-700`, color `--color-text-muted`, cursor not-allowed. `.upload-submit.active`: background `--color-accent`, color white, cursor pointer. `.upload-submit.active:hover`: background `--color-accent-hover`
- `.upload-total` — margin-top: `--space-3` (12px), font-size: `--font-size-sm`, text-align: right, color: `--color-text-secondary`
- `.upload-progress` — margin-top: `--space-3` (12px), display: none
- `.upload-progress-label` — margin-bottom: `--space-2` (8px), font-weight: `--font-weight-semibold`, font-size: `--font-size-sm`
- `.upload-progress-track` — same as existing `.progress-bar-track`
- `.upload-progress-fill` — same as existing `.progress-bar-fill`
- `.upload-progress-text` — position: absolute, top: 50%, left: 50%, transform: translate(-50%, -50%), font-weight: bold, font-size: `--font-size-sm`, color: `--color-text-primary`

**Job card grid and hierarchy** -- update existing job card CSS:

`.job-grid`:
- display: grid
- grid-template-columns: repeat(auto-fill, minmax(320px, 1fr))
- gap: `--space-3` (12px)

`.job-card` (update existing):
- padding: `--space-4` (16px) (down from --spacing-xl/32px for density)
- margin-bottom: 0 (grid handles gaps)
- border: 1px solid `--color-border` (thinner than current 2px)
- Remove `transform: translateX(4px)` on hover (grid cards shouldn't shift). Replace with subtle border-color and background change on hover.

`.job-card:hover`:
- border-color: `--color-accent`
- background: `--color-bg-elevated`

`.job-card-header`:
- margin-bottom: `--space-2` (8px, down from --spacing-md/12px)

`.job-card-title` (update):
- font-size: `--font-size-md` (1.125rem, up from --font-size-base/1rem) -- filenames are THE most prominent element
- font-weight: `--font-weight-bold` (up from semibold)
- max-width: none (remove 70% constraint, let it flow)
- white-space: nowrap, overflow: hidden, text-overflow: ellipsis
- Keep existing color

`.job-card-meta`:
- margin-bottom: `--space-2` (8px, reduced)
- font-size: `--font-size-xs` (smaller for data density)

`.job-card-source` (update for subtlety):
- font-size: 10px (very small)
- padding: 1px `--space-2` (8px)
- opacity: 0.7
- letter-spacing: 0.05em (tighter than current 0.5px)

`.job-card-actions`:
- display: flex
- gap: `--space-2` (8px)
- align-items: center

`.job-card.job-card-expired`:
- opacity: 0.5

`.expired-text`:
- font-size: `--font-size-xs`
- color: `--color-text-muted`
- font-style: italic

**Responsive for job grid:**
```css
@media (max-width: 700px) {
  .job-grid {
    grid-template-columns: 1fr;
  }
}
```
  </action>
  <verify>
Read styles.css and confirm: `.drop-zone`, `.drop-zone.dragover`, `.drop-zone.collapsed` classes exist. `.job-grid` with grid-template-columns exists. `.job-card-title` has font-size --font-size-md and font-weight --font-weight-bold. All `upload-*` classes present.
  </verify>
  <done>CSS classes for drop zone 3 states, upload view, and job card grid with refined hierarchy all defined in styles.css.</done>
</task>

<task type="auto">
  <name>Task 2: Rewrite upload view with drop zone states and CSS classes</name>
  <files>views/upload.js</files>
  <action>
Rewrite `renderUpload()` to use CSS classes from Task 1, eliminating all `style.cssText` assignments. Implement the 3-state drop zone (idle, dragover, collapsed).

**Drop zone structure (idle state):**
1. div.drop-zone containing:
   - div.drop-zone-icon: An SVG upload cloud icon as `innerHTML` (a simple path-based cloud-with-arrow SVG, ~24x24 viewBox scaled to 48px via CSS). Use a minimal inline SVG string. No emoji.
   - p.drop-zone-text: "Drop video files here or click to browse"
   - p.drop-zone-hint: "MP4 and MOV files accepted"
2. Click handler on drop zone opens file picker (existing behavior)

**Drag-over state:**
- On dragenter: add class `dragover` to drop zone (CSS handles glow + scale)
- On dragleave (only if leaving the drop zone, not entering a child): remove class `dragover`
- On drop: remove class `dragover`, add files, transition to collapsed state if files accepted

**Collapsed state (after files accepted):**
- After `addFiles()` is called and `selectedFiles.length > 0`:
  - Add class `collapsed` to drop zone
  - Create a `drop-zone-collapsed-label` span inside the drop zone with text like "Add more files" (clickable, opens picker)
  - The CSS hides the icon, text, and hint elements when `.collapsed` is present
- If all files are removed (selectedFiles back to 0):
  - Remove class `collapsed` from drop zone
  - Remove the collapsed-label span
  - Restore idle state

**File list:** Use CSS classes: `upload-file-list`, `upload-file-row`, `upload-file-name`, `upload-file-size`, `upload-file-remove`. Remove all inline styles.

**File list container:** Use `border: 1px solid var(--color-border); border-radius: var(--radius-sm); overflow: hidden;` via a CSS class. Actually, add `.upload-file-list-container` with those styles to Task 1's CSS. (If not already there, add it inline with a var() reference as a fallback.)

**Selected files heading:** Use class `upload-title` with smaller size variant or just h3 default.

**Other elements:** Mode section uses `upload-mode-section` and `upload-mode-option`. Warning uses `upload-warning`. Variation section uses `upload-variation-section` and `upload-variation-input`. Submit button uses `upload-submit` class with `.active` toggled based on file selection state. Progress section uses `upload-progress`, `upload-progress-track`, `upload-progress-fill`, `upload-progress-text`.

**Submit button state management:** Instead of directly setting `style.background` and `style.cursor`, toggle the `active` class:
- When files selected: `submitBtn.classList.add('active')`, `submitBtn.disabled = false`
- When no files: `submitBtn.classList.remove('active')`, `submitBtn.disabled = true`
- When uploading: `submitBtn.classList.remove('active')`, `submitBtn.disabled = true`

**Remove all inline style.cssText** assignments. The ONLY inline style allowed is `display: none/block` for showing/hiding the progress section and warning div (or use CSS classes for that too if convenient).

**Preserve all existing logic:** File validation, mode selection persistence, server upload with progress, device processing redirect, error handling. Only the DOM structure and styling approach changes.
  </action>
  <verify>
Read views/upload.js and confirm: no `style.cssText` assignments, drop zone uses `drop-zone`, `dragover`, and `collapsed` CSS classes, file list uses `upload-file-*` classes, submit button uses `upload-submit` class with `active` toggle.
  </verify>
  <done>Upload view fully uses CSS classes. Drop zone has 3 distinct visual states. No inline styles except display toggles.</done>
</task>

<task type="auto">
  <name>Task 3: Rewrite job list view with grid layout and refined card hierarchy</name>
  <files>views/job-list.js</files>
  <action>
Update `renderJobList()` and `renderJobsList()` to use the new grid layout and refined card hierarchy.

**Job list container:** Change `jobListContainer` to use class `job-grid` (CSS grid handles multi-column layout).

**Job card structure refinement:**
The current card structure is: header (title + badge) > meta (source + counts | timestamp) > actions. Keep this structure but ensure CSS classes control hierarchy:

1. `job-card` — padding reduced via CSS, hover effect is background change (not translateX)
2. `job-card-header` — title and status badge
3. `job-card-title` — now larger/bolder (CSS handles this), keep truncation
4. `job-card-meta` — source badge + counts + timestamp. The source badge should be very subtle per CSS
5. `job-card-actions` — use the CSS flex class for consistent spacing

**Empty state:** Use a class instead of inline style.display. Add `.empty-state` CSS or use existing. Show/hide by toggling a class or style.display.

**No new logic changes** -- this is purely a CSS class migration and ensuring the DOM structure works with the new grid/card CSS. All polling, cancel, and navigation logic stays unchanged.

**Remove the TODO comment** about migrating to CSS class (line 48 area).
  </action>
  <verify>
Read views/job-list.js and confirm: jobListContainer has class `job-grid`, no inline style.cssText assignments remain, job cards use existing CSS classes for hierarchy.
  </verify>
  <done>Job list uses grid layout. Cards display in multi-column grid with filenames as most prominent element. Source badges are subtle.</done>
</task>

</tasks>

<verification>
1. Open upload page: drop zone shows dashed border with cloud icon, drag files over it -- glow + scale appears
2. Drop files: zone collapses to compact "Add more files" bar, file list shown below
3. Remove all files: zone returns to idle state with icon
4. Open job list: cards in multi-column grid, filenames are biggest text, source badges are small/subtle
5. Resize browser narrow: cards stack to single column
6. All functionality preserved: upload, drag-drop, file validation, mode selection, job polling, cancel
</verification>

<success_criteria>
- Drop zone has 3 visually distinct states (idle, drag-over, collapsed)
- Drop zone click opens file picker in all states
- Job cards in multi-column grid (2-3 per row on desktop)
- Filenames are the most prominent card element
- Source badges subtle and non-competing
- No inline style.cssText in upload.js or job-list.js
- All existing functionality preserved
</success_criteria>

<output>
After completion, create `.planning/phases/18-visual-polish/18-02-SUMMARY.md`
</output>

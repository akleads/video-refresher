---
phase: 14-css-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - styles.css
  - views/login.js
  - views/upload.js
  - views/job-list.js
  - views/job-detail.js
  - views/device-progress.js
autonomous: true

must_haves:
  truths:
    - "All color values reference CSS variables, no hardcoded hex/rgb colors remain"
    - "All spacing values reference CSS variables, no hardcoded px values in layout properties"
    - "Visual appearance uses new dark-mode grayscale palette with bright blue accent"
    - "Navigation, cards, and buttons use consistent color scheme from variables"
  artifacts:
    - path: "styles.css"
      provides: "CSS custom properties in :root block"
      contains: "--color-"
      min_lines: 350
    - path: "styles.css"
      provides: "Dark palette applied to base styles"
      contains: "var(--color-"
    - path: "views/login.js"
      provides: "Inline styles use var() references"
      contains: "var(--"
    - path: "views/upload.js"
      provides: "Inline styles use var() references"
      contains: "var(--"
    - path: "views/job-list.js"
      provides: "Inline styles use var() references (if any)"
      contains: "// TODO: migrate to CSS class"
    - path: "views/job-detail.js"
      provides: "Inline styles use var() references"
      contains: "var(--"
    - path: "views/device-progress.js"
      provides: "Inline styles use var() references"
      contains: "var(--"
  key_links:
    - from: "styles.css :root block"
      to: "styles.css selectors"
      via: "var() references"
      pattern: "var\\(--color-|var\\(--spacing-|var\\(--radius-"
    - from: "styles.css :root block"
      to: "views/*.js inline styles"
      via: "var() references in cssText"
      pattern: "cssText.*var\\(--"
---

<objective>
Establish CSS custom properties foundation with new dark-mode grayscale palette and migrate all hardcoded style values to use variables.

Purpose: Create consistent, maintainable design token system while applying new dark aesthetic (grayscale with bright blue accent). This enables future polish work in Phase 18 without fighting inconsistent values.

Output: All colors, spacing, typography, shadows, and border-radius values defined as CSS custom properties. New dark palette applied throughout. Inline styles migrated to var() references with TODO comments for Phase 18 CSS class migration.
</objective>

<execution_context>
@/Users/alexkozhemiachenko/.claude/get-shit-done/workflows/execute-plan.md
@/Users/alexkozhemiachenko/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-css-foundation/14-CONTEXT.md

Phase 14 combines structural refactor (CSS variable extraction) with visual redesign (dark palette swap) in one phase. User decisions from CONTEXT.md are LOCKED and non-negotiable:
- Replace purple-pink gradient theme entirely with grayscale
- Primary accent: bright blue (#3b82f6)
- Dark mode: near-black background, white text, grades of gray
- Keep inline cssText structure intact, add TODO comments for Phase 18
- Cover ALL views: login, upload, job-list, job-detail, device-progress
</context>

<tasks>

<task type="auto">
  <name>Task 1: Define CSS custom properties with dark palette</name>
  <files>styles.css</files>
  <action>
Create :root block at the top of styles.css defining all design tokens organized by type:

**Color system (dark-mode grayscale with bright blue accent):**
- Base grayscale: --color-gray-50 through --color-gray-950 (near-black to near-white)
  - Use true blacks/grays (#0a0a0a, #1a1a1a, #2a2a2a, etc.) for monochrome feel
  - Near-black background: --color-gray-950 (#0a0a0a or similar)
  - White text: --color-gray-50 (#f9f9f9 or pure white)
- Primary accent: --color-blue-500 (#3b82f6) for action buttons
- Status colors (muted for dark backgrounds):
  - Success: --color-green-600 (#059669 or similar muted green)
  - Error: --color-red-600 (#dc2626 or similar muted red)
  - Info: --color-blue-400 (#60a5fa)
  - Neutral: --color-gray-400 (#9ca3af)

**Semantic color aliases:**
- --color-bg-primary: var(--color-gray-950)
- --color-bg-secondary: var(--color-gray-900)
- --color-bg-card: var(--color-gray-900)
- --color-text-primary: var(--color-gray-50)
- --color-text-secondary: var(--color-gray-400)
- --color-border: var(--color-gray-800)
- --color-accent: var(--color-blue-500)

**Spacing scale:**
- --spacing-xs through --spacing-3xl (0.25rem, 0.5rem, 0.75rem, 1rem, 1.5rem, 2rem, 3rem, 4rem)

**Typography:**
- --font-size-xs through --font-size-3xl (0.75rem, 0.875rem, 1rem, 1.125rem, 1.25rem, 1.5rem, 2rem, 3rem)
- --font-weight-normal: 400
- --font-weight-medium: 500
- --font-weight-semibold: 600
- --font-weight-bold: 700
- --line-height-tight: 1.25
- --line-height-normal: 1.5
- --line-height-relaxed: 1.75

**Border radius:**
- --radius-sm: 4px
- --radius-md: 6px
- --radius-lg: 8px
- --radius-xl: 12px
- --radius-full: 9999px

**Shadows (subtle for dark mode):**
- --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.5)
- --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.5)
- --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.6)
- --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.7)

**Gradient (remove or replace with solid dark):**
- Either remove gradient entirely and use --color-bg-primary
- Or create subtle dark gradient: --gradient-primary: linear-gradient(135deg, var(--color-gray-950) 0%, var(--color-gray-900) 100%)

Apply new palette to existing selectors. User decision: Replace purple-pink gradient theme entirely. Navigation background should be same dark tone as page with subtle border/shade for separation (not colorful gradient).
  </action>
  <verify>
Check styles.css contains :root block with all variable definitions. Verify grayscale palette uses true blacks/grays (not just dark grays). Confirm bright blue (#3b82f6) defined for accent. Check body background no longer uses purple-pink gradient.
  </verify>
  <done>
CSS custom properties defined in :root block covering colors (grayscale + blue accent), spacing, typography, shadows, and border-radius. New dark palette applied to body and navigation styles.
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate styles.css to use CSS variables</name>
  <files>styles.css</files>
  <action>
Replace all hardcoded values in styles.css selectors with var() references to the custom properties defined in Task 1.

**What to migrate:**
- Colors: All hex codes, rgb(), rgba() -> var(--color-*)
- Spacing: padding, margin values -> var(--spacing-*)
- Typography: font-size -> var(--font-size-*), font-weight -> var(--font-weight-*)
- Border radius: border-radius values -> var(--radius-*)
- Shadows: box-shadow values -> var(--shadow-*)

**Specific areas:**
- body: background gradient -> var(--color-bg-primary) or var(--gradient-primary) if keeping subtle dark gradient
- #app: background, box-shadow
- .nav: background (replace purple gradient with var(--color-bg-secondary) or similar), color
- .nav-tab: colors, hover states
- .nav-logout: colors, hover states, border
- .btn-primary: background (use var(--color-accent) for bright blue), hover states
- .btn-secondary, .btn-danger: colors
- Badge classes (.badge-*): Adapt to dark mode with muted status colors
- Progress bars: .progress-bar-fill background (replace purple gradient with var(--color-accent))
- Job cards: background, border colors, hover states

**Visual result:** App should feel like a tool with monochrome aesthetic. Action buttons (login, submit, primary CTAs) use bright blue to stand out. Purple-pink theme completely replaced.
  </action>
  <verify>
Run `grep -E "#[0-9a-f]{3,6}|rgb\(|rgba\(" styles.css` to check for remaining hardcoded color values. Check body background no longer references #667eea or #764ba2. Verify .btn-primary uses var(--color-accent). Open app in browser and confirm dark aesthetic with blue action buttons.
  </verify>
  <done>
All hardcoded values in styles.css replaced with var() references. Purple-pink gradient theme removed. Dark grayscale palette with bright blue accent applied throughout. No hex color codes remain except in :root block definitions.
  </done>
</task>

<task type="auto">
  <name>Task 3: Migrate inline styles in views to CSS variables</name>
  <files>
    views/login.js
    views/upload.js
    views/job-list.js
    views/job-detail.js
    views/device-progress.js
  </files>
  <action>
For each view file, find all inline style assignments (element.style.cssText, element.style.property) and replace hardcoded values with var() references to CSS custom properties.

**Per user decision: Keep inline cssText structure intact.** Do NOT refactor to CSS classes yet. Add comment `// TODO: migrate to CSS class` above each cssText block for Phase 18.

**Views to cover:**

**login.js:**
- formWrapper cssText: Replace hardcoded padding, margin with var(--spacing-*)
- subtitle color: Replace #666 with var(--color-text-secondary)
- errorDiv cssText: Replace #fee, #c33 with var(--color-error-bg), var(--color-error-text) or define these
- passwordInput cssText: Replace border color #ccc with var(--color-border), padding with var(--spacing-*)
- submitBtn cssText: Replace #0066cc with var(--color-accent), hover color #0052a3 with adjusted accent
- submitBtn disabled background: Replace #ccc with var(--color-gray-600)

**upload.js:**
- wrapper cssText: Replace padding, margin with var(--spacing-*)
- instructions color: Replace #666 with var(--color-text-secondary)
- modeSection cssText: Replace gap, margin with var(--spacing-*)
- dropZone cssText: Replace #ccc with var(--color-border), padding with var(--spacing-*), border-radius with var(--radius-lg)
- dropZone hover: Replace #f0f8ff with var(--color-bg-hover), #0066cc with var(--color-accent)
- dropText color: Replace #666 with var(--color-text-secondary)
- All other inline color/spacing values

**job-list.js:**
- Minimal inline styles detected (mostly display toggling). If any color/spacing values exist, migrate them.

**job-detail.js:**
- Check for inline cssText assignments and migrate any hardcoded values

**device-progress.js:**
- Check for inline cssText assignments and migrate any hardcoded values

**Define additional semantic variables if needed:**
- --color-error-bg, --color-error-text for error messages
- --color-bg-hover for interactive hover states
- --color-input-border for form inputs

Add these to :root block in styles.css if not already defined in Task 1.
  </action>
  <verify>
Run `grep -E "#[0-9a-f]{3,6}|'[0-9]+px|\"[0-9]+px" views/*.js` to check for remaining hardcoded values in inline styles. Verify each cssText block has `// TODO: migrate to CSS class` comment above it. Check login view in browser - submit button should be bright blue, not old #0066cc.
  </verify>
  <done>
All inline styles in view files use var() references to CSS custom properties. No hardcoded hex colors or fixed px values remain in cssText assignments (except for display, cursor, and other non-token properties). TODO comments added above each cssText block for Phase 18 migration.
  </done>
</task>

</tasks>

<verification>
1. Visual check: Open app in browser, navigate through all views (login, upload, job-list, job-detail, device-progress if accessible)
2. Appearance: Dark background (near-black), white text, grayscale surfaces, bright blue buttons
3. Navigation: Dark tone matching page background, no purple-pink gradient
4. Consistency: All cards, buttons, and interactive elements use same color scheme
5. Code check: Run `grep -E "#[0-9a-f]{3,6}(?!.*:root)" styles.css views/*.js` - should only match :root definitions
6. No hardcoded spacing: Search for hardcoded px values in layout properties (padding, margin, gap) - should use var(--spacing-*)
</verification>

<success_criteria>
1. CSS custom properties defined in styles.css :root block with complete design token system
2. Dark-mode grayscale palette with bright blue accent (#3b82f6) applied throughout
3. Purple-pink gradient theme completely removed
4. All styles.css selectors use var() references instead of hardcoded values
5. All view files' inline styles use var() references instead of hardcoded values
6. TODO comments added to inline cssText blocks for Phase 18 CSS class migration
7. Visual appearance: Monochrome tool aesthetic with blue action buttons standing out
8. App functional and visually consistent across all views
</success_criteria>

<output>
After completion, create `.planning/phases/14-css-foundation/14-01-SUMMARY.md`
</output>

# Requirements Archive: v2.0 Server-Side Multi-Video Processing

**Archived:** 2026-02-08
**Status:** SHIPPED

This is the archived requirements specification for v2.0.

---

# Requirements: Video Refresher v2.0

**Defined:** 2026-02-07
**Core Value:** Upload video creatives, get multiple unique variations ready for ad platform rotation -- fast, without waiting at the screen.

## v2.0 Requirements

Requirements for server-side multi-video processing milestone. Each maps to roadmap phases.

### Infrastructure

- [x] **INFRA-01**: Backend deploys to Fly.io as Docker container with Node.js 22 + native FFmpeg
- [x] **INFRA-02**: Express 5 API server with REST endpoints for jobs, auth, and downloads
- [x] **INFRA-03**: SQLite database on 3GB Fly Volume for job tracking and session state
- [x] **INFRA-04**: Shared password authentication with bearer token sessions
- [x] **INFRA-05**: CORS configuration for Cloudflare Pages frontend

### Processing

- [x] **PROC-01**: User can upload multiple MP4 source videos in a single batch
- [x] **PROC-02**: Server processes videos with native FFmpeg using same random effects as v1
- [x] **PROC-03**: In-process job queue backed by SQLite (no Redis)
- [x] **PROC-04**: Job status endpoint with per-video progress percentage
- [x] **PROC-05**: Fire-and-forget -- jobs continue processing after browser tab closes
- [x] **PROC-06**: Job recovery on server restart (interrupted jobs marked and retryable)

### Storage

- [x] **STOR-01**: Processed videos stored on 3GB Fly Volume with 24-hour auto-expiry
- [x] **STOR-02**: Automatic eviction of oldest results when storage cap exceeded
- [x] **STOR-03**: Cleanup daemon runs periodically to enforce time and size limits
- [x] **STOR-04**: Upload files deleted after processing completes (not held for 24h)

### Download

- [x] **DOWN-01**: Single streaming ZIP download with all variations organized by source video
- [x] **DOWN-02**: ZIP uses STORE compression (no re-compression of H.264 video)
- [x] **DOWN-03**: Download available until job expires (24h) or evicted

### Frontend

- [x] **FEND-01**: Login screen with shared password input
- [x] **FEND-02**: Multi-video upload UI (drag-and-drop or file picker for multiple files)
- [x] **FEND-03**: Variation count input per batch
- [x] **FEND-04**: Progress display with polling (per-video status)
- [x] **FEND-05**: Job list page showing all active/completed/expired jobs
- [x] **FEND-06**: Download button linking to server ZIP endpoint
- [x] **FEND-07**: Remove FFmpeg.wasm and all client-side processing code

## Future Requirements

Deferred to post-v2.0 milestones.

- **SSE-01**: Server-Sent Events for real-time progress (polling fallback already in v2.0)
- **META-01**: Metadata JSON manifest in ZIP documenting effects applied per variation
- **CANCEL-01**: Job cancellation (kill in-progress FFmpeg, clean up files)
- **RETRY-01**: Retry individual failed videos without re-uploading entire batch
- **RESUME-01**: Resumable uploads for large files over unreliable connections

## Out of Scope

| Feature | Reason |
|---------|--------|
| Per-user accounts | Shared password sufficient for small team |
| Video format conversion (MOV, AVI) | MP4 is standard for ad platforms |
| WebSocket video frame streaming | Progress percentage is enough |
| Cloud object storage (S3/R2) | Fly Volume is sufficient at 3GB |
| Persistent history beyond 24h | Temporary storage model |
| Manual effect selection | Defeats "quick refresh" value prop |
| Horizontal scaling / multi-worker | Single machine sufficient for <10 users |
| Queue priority system | FIFO is fair for small team |
| Video preview/streaming from server | Download and preview locally |

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| INFRA-01 | Phase 6 | Complete |
| INFRA-02 | Phase 6 | Complete |
| INFRA-03 | Phase 6 | Complete |
| INFRA-04 | Phase 6 | Complete |
| INFRA-05 | Phase 6 | Complete |
| PROC-01 | Phase 6 | Complete |
| PROC-02 | Phase 7 | Complete |
| PROC-03 | Phase 6 | Complete |
| PROC-04 | Phase 7 | Complete |
| PROC-05 | Phase 7 | Complete |
| PROC-06 | Phase 7 | Complete |
| STOR-01 | Phase 8 | Complete |
| STOR-02 | Phase 8 | Complete |
| STOR-03 | Phase 8 | Complete |
| STOR-04 | Phase 8 | Complete |
| DOWN-01 | Phase 8 | Complete |
| DOWN-02 | Phase 8 | Complete |
| DOWN-03 | Phase 8 | Complete |
| FEND-01 | Phase 9 | Complete |
| FEND-02 | Phase 9 | Complete |
| FEND-03 | Phase 9 | Complete |
| FEND-04 | Phase 9 | Complete |
| FEND-05 | Phase 9 | Complete |
| FEND-06 | Phase 9 | Complete |
| FEND-07 | Phase 9 | Complete |

**Coverage:**
- v2.0 requirements: 25 total
- Shipped: 25
- Dropped: 0

---

## Milestone Summary

**Shipped:** 25 of 25 v2.0 requirements
**Adjusted:** None â€” all requirements shipped as originally specified
**Dropped:** None

---
*Archived: 2026-02-08 as part of v2.0 milestone completion*
